<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>System design reading exercise | The Essence of Software</title>
<meta name="keywords" content="">
<meta name="description" content="Learning about system design by reading concept specs and syncs">
<meta name="author" content="Daniel Jackson">
<link rel="canonical" href="https://essenceofsoftware.com/exercises/system-reading/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.aa2bfdef797952672daec0a939a38dd67fec418d7067292a61ff5203ea5bb643.css" integrity="sha256-qiv973l5UmctrsCpOaON1n/sQY1wZykqYf9SA&#43;pbtkM=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://essenceofsoftware.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://essenceofsoftware.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://essenceofsoftware.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://essenceofsoftware.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://essenceofsoftware.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://essenceofsoftware.com/exercises/system-reading/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-WRQ6HWW3ZW"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-WRQ6HWW3ZW');
        }
      </script><meta property="og:url" content="https://essenceofsoftware.com/exercises/system-reading/">
  <meta property="og:site_name" content="The Essence of Software">
  <meta property="og:title" content="System design reading exercise">
  <meta property="og:description" content="Learning about system design by reading concept specs and syncs">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="exercises">
    <meta property="article:published_time" content="2025-07-24T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-07-24T00:00:00+00:00">
      <meta property="og:image" content="https://essenceofsoftware.com/eos-twitter-card.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://essenceofsoftware.com/eos-twitter-card.png">
<meta name="twitter:title" content="System design reading exercise">
<meta name="twitter:description" content="Learning about system design by reading concept specs and syncs">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Exercises",
      "item": "https://essenceofsoftware.com/exercises/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "System design reading exercise",
      "item": "https://essenceofsoftware.com/exercises/system-reading/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "System design reading exercise",
  "name": "System design reading exercise",
  "description": "Learning about system design by reading concept specs and syncs",
  "keywords": [
    
  ],
  "articleBody": "To help you get going with designing systems of concepts, this exercise asks you to read a a few concepts and syncs and answer some questions about them.\nConcepts Consider the task of designing a URL shortening service. We might define three concepts: URLShortening, which maintains mappings between the short URLs and their expansions; ExpiringResource, which manages the relinquishing of resources that have finite lifetimes; and NonceGeneration, which generates the unique strings that the shortener uses. Here are some abbreviated specifications of the concepts:\nA UrlShortening Concept concept UrlShortening\npurpose shorter or more memorable way to link\nprinciple after create generates a short url, lookup will return the original url\nstate\na set of Shortenings with\na targetUrl String a shortUrl String actions register (shortUrlSuffix, shortUrlBase, targetUrl: String): (shortUrl: String)\nforms and saves a new short URL by appending the suffix to the base and associates it with the targetUrl lookup (shortUrl: String): (targetUrl: String)\nreturns the target URL associated with a short URL delete (shortUrl: String)\ndeletes a short URL and its association with a target URL A NonceGenerator Concept concept NonceGenerator [Context]\npurpose generate unique strings within a context\nprinciple each generate returns a string not returned before for that context\nstate\na set of Contexts with\na used set of Strings actions\ngenerate (context: Context) : (nonce: String)\nreturn a nonce that is not already used by this context An ExpiringResource Concept concept ExpiringResource [Resource]\npurpose expire resources automatically to manage costs\nprinciple after setting expiry for a resource, the system will expire it after the given time\nstate\na set of Resources with\nan expiry DateTime actions\nsetExpiry (resource: Resource, seconds: Int)\nsystem expireResource () : (resource: Resource)\nSome explanatory notes The expireResource action of ExpiringResource is a system action, performed spontaneously when its precondition is true (namely when the expiry time for some resource, which it returns, has arrived). The register action of UrlShortening takes a base URL; this ensures that the concept is not hardwired to a particular domain (such as tinyurl.com), and would allow the service to support user-specific domain names. Concept Questions Read the concept specifications carefully and answer these questions:\nContexts. The NonceGenerator concept ensures that the short strings it generates will be unique and not result in conflicts. What are the contexts for, and what might a context end up being in the URL shortening app? Storing used strings. Why must the NonceGenerator store sets of used strings? One simple way to implement the NonceGenerator is to maintain a counter for each context and increment it every time the generate action is called. In this case, how is the set of used strings in the specification related to the counter in the implementation? (In abstract data type lingo, this is asking you to describe an abstraction function.) Words as nonces. One attractive option for nonce generation is to use common dictionary words (in the style of yellkey.com, for example) resulting in more easily remembered shortenings. What are some disadvantages of this scheme? How would a variant of the NonceGenerator concept defined for this purpose differ from NonceGenerator? (Hint: consider in particular the state, and the generate action.) Synchronizations Here are three of the synchronizations that might be included in a full design of the URL shortening application:\nsync generate\nwhen Web.request (method: “shortenUrl”, shortUrlBase)\nthen NonceGenerator.generate (context: shortUrlBase)\nsync register\nwhen Web.request (method: “shortenUrl”, targetUrl, shortUrlBase) and NonceGenerator.generate (): (nonce)\nthen UrlShortening.register (shortUrlSuffix: nonce, shortUrlBase, targetUrl)\nsync setExpiry\nwhen UrlShortening.register (): (shortUrl)\nthen ExpiringResource.setExpiry (resource: shortUrl, seconds: 3600)\nSome explanatory notes Completions and invocations. In the synchronization language, actions referred to in the when clause always correspond to action completions, and actions in the then clause to action invocations. Named arguments and results. The arguments and return values of actions are named (they’re represented in the code simply as dictionaries), so, for example, the first sync invokes in its then clause the generate action of the NonceGenerator concept with the argument named context bound to shortUrlBase. Bound variables. The when clause can bind variables used in the other clauses; for example, the return of expireResource in the last sync says that the return value given by the return name resource is bound to the variable shortUrl. This bound variable is then passed as an argument to the delete action in the then clause. Omitted names. By convention, it is not necessary to include both the argument name and the bound variable name when they are the same (writing “x: x”), and mentioning the name once is short for this. So the mention of targetUrl in the when clause of the first sync is short for targetUrl: targetUrl, and binds the variable targetUrl to the argument of the request action called targetUrl. Synchronization Questions Read the synchronizations carefully and answer these questions:\nPartial matching. In the first sync (called generate), the Web.request action in the when clause includes the shortUrlBase argument but not the targetUrl argument. In the second sync (called register) both appear. Why is this? Omitting names. The convention that allows names to be omitted when argument or result names are the same as their variable names is convenient and allows for a more succinct specification. Why isn’t this convention used in every case? Inclusion of request. Why is the request action included in the first two syncs but not the third one? Fixed domain. Suppose the application did not support alternative domain names, and always used a fixed one such as “bit.ly.” How would you change the synchronizations to implement this? Adding a sync. These synchronizations are not complete; in particular, they don’t do anything when a resource expires. Write a sync for this case, using appropriate actions from the ExpiringResource and URLShortening concepts. ",
  "wordCount" : "956",
  "inLanguage": "en",
  "image": "https://essenceofsoftware.com/eos-twitter-card.png","datePublished": "2025-07-24T00:00:00Z",
  "dateModified": "2025-07-24T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Daniel Jackson"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://essenceofsoftware.com/exercises/system-reading/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "The Essence of Software",
    "logo": {
      "@type": "ImageObject",
      "url": "https://essenceofsoftware.com/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://essenceofsoftware.com/" accesskey="h" title="The Essence of Software (Alt + H)">The Essence of Software</a>
            <div class="logo-switches">
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://essenceofsoftware.com/ask/" title="FAQ">
                    <span>FAQ</span>
                </a>
            </li>
            <li>
                <a href="https://essenceofsoftware.com/buy/" title="Buy">
                    <span>Buy</span>
                </a>
            </li>
            <li>
                <a href="https://essenceofsoftware.com/reviews/" title="Reviews">
                    <span>Reviews</span>
                </a>
            </li>
            <li>
                <a href="https://essenceofsoftware.com/author/" title="Author">
                    <span>Author</span>
                </a>
            </li>
            <li>
                <a href="https://essenceofsoftware.com/posts/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://essenceofsoftware.com/tutorials/" title="Tutorials">
                    <span>Tutorials</span>
                </a>
            </li>
            <li>
                <a href="https://essenceofsoftware.com/studies/" title="Case Studies">
                    <span>Case Studies</span>
                </a>
            </li>
            <li>
                <a href="https://essenceofsoftware.com/subscribe/" title="Subscribe">
                    <span>Subscribe</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      System design reading exercise
    </h1>
    <div class="post-description">
      Learning about system design by reading concept specs and syncs
    </div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#concepts" aria-label="Concepts">Concepts</a><ul>
                        
                <li>
                    <a href="#a-urlshortening-concept" aria-label="A UrlShortening Concept">A UrlShortening Concept</a></li>
                <li>
                    <a href="#a-noncegenerator-concept" aria-label="A NonceGenerator Concept">A NonceGenerator Concept</a></li>
                <li>
                    <a href="#an-expiringresource-concept" aria-label="An ExpiringResource Concept">An ExpiringResource Concept</a></li>
                <li>
                    <a href="#some-explanatory-notes" aria-label="Some explanatory notes">Some explanatory notes</a></li>
                <li>
                    <a href="#concept-questions" aria-label="Concept Questions">Concept Questions</a></li></ul>
                </li>
                <li>
                    <a href="#synchronizations" aria-label="Synchronizations">Synchronizations</a><ul>
                        
                <li>
                    <a href="#some-explanatory-notes-1" aria-label="Some explanatory notes">Some explanatory notes</a></li>
                <li>
                    <a href="#synchronization-questions" aria-label="Synchronization Questions">Synchronization Questions</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>To help you get going with designing systems of concepts, this exercise asks you to read a a few concepts and syncs  and answer some questions about them.</p>
<h2 id="concepts">Concepts<a hidden class="anchor" aria-hidden="true" href="#concepts">#</a></h2>
<p>Consider the task of designing a URL shortening service. We might define three concepts: URLShortening, which maintains mappings between the short URLs and their expansions; ExpiringResource, which manages the relinquishing of resources that have finite lifetimes; and NonceGeneration, which generates the unique strings that the shortener uses. Here are some abbreviated specifications of the concepts:</p>
<h3 id="a-urlshortening-concept">A UrlShortening Concept<a hidden class="anchor" aria-hidden="true" href="#a-urlshortening-concept">#</a></h3>
<p><strong>concept</strong> UrlShortening<br>
<strong>purpose</strong> shorter or more memorable way to link<br>
<strong>principle</strong> after create generates a short url, lookup will return the original url<br>
<strong>state</strong><br>
a set of Shortenings with</p>
<ul>
<li>a targetUrl String</li>
<li>a shortUrl String</li>
</ul>
<p><strong>actions</strong> <br>
register (shortUrlSuffix, shortUrlBase, targetUrl: String): (shortUrl: String)</p>
<ul>
<li>forms and saves a new short URL by appending the suffix to the base and associates it with the targetUrl</li>
</ul>
<p>lookup  (shortUrl: String): (targetUrl: String)</p>
<ul>
<li>returns the target URL associated with a short URL</li>
</ul>
<p>delete  (shortUrl: String)</p>
<ul>
<li>deletes a short URL and its association with a target URL</li>
</ul>
<h3 id="a-noncegenerator-concept">A NonceGenerator Concept<a hidden class="anchor" aria-hidden="true" href="#a-noncegenerator-concept">#</a></h3>
<p><strong>concept</strong> NonceGenerator [Context]</p>
<p><strong>purpose</strong> generate unique strings within a context</p>
<p><strong>principle</strong> each generate returns a string not returned before for that context</p>
<p><strong>state</strong><br>
a set of Contexts with</p>
<ul>
<li>a used set of Strings</li>
</ul>
<p><strong>actions</strong><br>
generate (context: Context) : (nonce: String)</p>
<ul>
<li>return a nonce that is not already used by this context</li>
</ul>
<h3 id="an-expiringresource-concept">An ExpiringResource Concept<a hidden class="anchor" aria-hidden="true" href="#an-expiringresource-concept">#</a></h3>
<p><strong>concept</strong> ExpiringResource [Resource]</p>
<p><strong>purpose</strong> expire resources automatically to manage costs</p>
<p><strong>principle</strong> after setting expiry for a resource, the system will expire it after the given time</p>
<p><strong>state</strong><br>
a set of Resources with</p>
<ul>
<li>an expiry DateTime</li>
</ul>
<p><strong>actions</strong><br>
setExpiry (resource: Resource, seconds: Int)</p>
<p>system expireResource () : (resource: Resource)</p>
<h3 id="some-explanatory-notes">Some explanatory notes<a hidden class="anchor" aria-hidden="true" href="#some-explanatory-notes">#</a></h3>
<ul>
<li>The expireResource action of ExpiringResource is a system action, performed spontaneously when its precondition is true (namely when the expiry time for some resource, which it returns, has arrived).</li>
<li>The register action of UrlShortening takes a base URL; this ensures that the concept is not hardwired to a particular domain (such as tinyurl.com), and would allow the service to support user-specific domain names.</li>
</ul>
<h3 id="concept-questions">Concept Questions<a hidden class="anchor" aria-hidden="true" href="#concept-questions">#</a></h3>
<p>Read the concept specifications carefully and answer these questions:</p>
<ul>
<li><strong>Contexts</strong>. The NonceGenerator concept ensures that the short strings it generates will be unique and not result in conflicts. What are the contexts for, and what might a context end up being in the URL shortening app?</li>
<li><strong>Storing used strings</strong>. Why must the NonceGenerator store sets of used strings? One simple way to implement the NonceGenerator is to maintain a counter for each context and increment it every time the generate action is called. In this case, how is the set of used strings in the specification related to the counter in the implementation? (In abstract data type lingo, this is asking you to describe an <em>abstraction function</em>.)</li>
<li><strong>Words as nonces</strong>. One attractive option for nonce generation is to use common dictionary words (in the style of <a href="http://yellkey.com">yellkey.com</a>, for example) resulting in more easily remembered shortenings. What are some disadvantages of this scheme? How would a variant of the NonceGenerator concept defined for this purpose differ from NonceGenerator? (Hint: consider in particular the state, and the generate action.)</li>
</ul>
<h2 id="synchronizations">Synchronizations<a hidden class="anchor" aria-hidden="true" href="#synchronizations">#</a></h2>
<p>Here are three of the synchronizations that might be included in a full design of the URL shortening application:</p>
<p><strong>sync</strong> generate<br>
<strong>when</strong> Web.request (method: &ldquo;shortenUrl&rdquo;, shortUrlBase)<br>
<strong>then</strong> NonceGenerator.generate (context: shortUrlBase)</p>
<p><strong>sync</strong> register<br>
<strong>when</strong> Web.request (method: &ldquo;shortenUrl&rdquo;, targetUrl, shortUrlBase) and
NonceGenerator.generate (): (nonce)<br>
<strong>then</strong> UrlShortening.register (shortUrlSuffix: nonce, shortUrlBase, targetUrl)</p>
<p><strong>sync</strong> setExpiry<br>
<strong>when</strong> UrlShortening.register (): (shortUrl)<br>
<strong>then</strong> ExpiringResource.setExpiry (resource: shortUrl, seconds: 3600)</p>
<h3 id="some-explanatory-notes-1">Some explanatory notes<a hidden class="anchor" aria-hidden="true" href="#some-explanatory-notes-1">#</a></h3>
<ul>
<li><strong>Completions and invocations</strong>. In the synchronization language, actions referred to in the when clause always correspond to action <em>completions</em>, and actions in the then clause to action <em>invocations</em>.</li>
<li><strong>Named arguments and results</strong>. The arguments and return values of actions are <em>named</em> (they&rsquo;re represented in the code simply as dictionaries), so, for example, the first sync invokes in its then clause the generate action of the NonceGenerator concept with the argument named <em>context</em> bound to shortUrlBase.</li>
<li><strong>Bound variables</strong>. The when clause can bind variables used in the other clauses; for example, the return of expireResource in the last sync says that the return value given by the return name <em>resource</em> is bound to the variable <em>shortUrl</em>. This bound variable is then passed as an argument to the delete action in the then clause.</li>
<li><strong>Omitted names</strong>. By convention, it is not necessary to include both the argument name and the bound variable name when they are the same (writing &ldquo;x: x&rdquo;), and mentioning the name once is short for this. So the mention of targetUrl in the when clause of the first sync is short for targetUrl: targetUrl, and binds the variable targetUrl to the argument of the request action called targetUrl.</li>
</ul>
<h3 id="synchronization-questions">Synchronization Questions<a hidden class="anchor" aria-hidden="true" href="#synchronization-questions">#</a></h3>
<p>Read the synchronizations carefully and answer these questions:</p>
<ul>
<li><strong>Partial matching</strong>. In the first sync (called generate), the Web.request action in the when clause includes the shortUrlBase argument but not the targetUrl argument. In the second sync (called register) both appear. Why is this?</li>
<li><strong>Omitting names</strong>. The convention that allows names to be omitted when argument or result names are the same as their variable names is convenient and allows for a more succinct specification. Why isn&rsquo;t this convention used in every case?</li>
<li><strong>Inclusion of request</strong>. Why is the request action included in the first two syncs but not the third one?</li>
<li><strong>Fixed domain</strong>. Suppose the application did not support alternative domain names, and always used a fixed one such as &ldquo;bit.ly.&rdquo; How would you change the synchronizations to implement this?</li>
<li><strong>Adding a sync</strong>. These synchronizations are not complete; in particular, they don&rsquo;t do anything when a resource expires. Write a sync for this case, using appropriate actions from the ExpiringResource and URLShortening concepts.</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>

  </footer>
</article>
    </main>
    
<footer class="footer">


    <span>&copy; 2025 <a href="https://essenceofsoftware.com/">Daniel Jackson</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
